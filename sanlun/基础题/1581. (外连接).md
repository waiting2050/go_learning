# 【SQL实战笔记】统计未交易顾客的访问次数
## 一、需求说明
已知 `Visits` 表（顾客访问记录）和 `Transactions` 表（顾客交易记录），筛选“光顾但未进行交易”的顾客，统计每个顾客的未交易访问次数，结果顺序不限。

## 二、表结构
| 表名 | 字段 | 类型 | 说明 |
|------|------|------|------|
| `Visits` | `visit_id` | int | 访问唯一标识（主键） |
| | `customer_id` | int | 顾客ID |
| `Transactions` | `transaction_id` | int | 交易唯一标识（主键） |
| | `visit_id` | int | 关联访问记录的外键 |
| | `amount` | int | 交易金额 |

## 三、示例数据
### 输入：Visits 表
| visit_id | customer_id |
|----------|-------------|
| 1        | 23          |
| 2        | 9           |
| 4        | 30          |
| 5        | 54          |
| 6        | 96          |
| 7        | 54          |
| 8        | 54          |

### 输入：Transactions 表
| transaction_id | visit_id | amount |
|----------------|----------|--------|
| 2              | 5        | 310    |
| 3              | 5        | 300    |
| 9              | 5        | 200    |
| 12             | 1        | 910    |
| 13             | 2        | 970    |

### 输出
| customer_id | count_no_trans |
|-------------|----------------|
| 54          | 2              |
| 30          | 1              |
| 96          | 1              |

## 四、SQL代码
```sql
# Write your MySQL query statement below
select 
  v.customer_id, 
  count(*) count_no_trans 
from Visits v
left join Transactions t 
on v.visit_id = t.visit_id 
where t.transaction_id is NULL
group by v.customer_id;
```

## 注意
1. 若两个表列名不重复是可以不用起别名直接用的，不会冲突
2. `null`不能用`=`来匹配，得用`is`或`is not`
3. `count`匹配的是全部的行数，加上`group by`才是每个组对应的`count`
4. `count(*)`会连`null`一起统计，但是之后要用`where`,`group by`...来辅助
