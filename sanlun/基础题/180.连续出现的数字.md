### 标题：查询连续出现至少三次的数字


#### 问题
从 `Logs` 表中找出至少连续出现三次的数字，`id` 是自增主键。

#### 示例数据
**Logs表**
| id  | num |
|-----|-----|
| 1   | 1   |
| 2   | 1   |
| 3   | 1   |
| 4   | 2   |
| 5   | 1   |
| 6   | 2   |
| 7   | 2   |

**输出**
| ConsecutiveNums |
|-----------------|
| 1               |


#### 核心思路
用 `id - row_number()` 标记连续区间：
1. 按 `num` 分组，组内按 `id` 排序生成序号（`row_number()`）；
2. 连续出现的相同 `num`，`id` 与序号差值（`dif`）相同；
3. 按 `num` 和 `dif` 分组，统计次数≥3的组。


#### 代码
```sql
select distinct num ConsecutiveNums 
from (
    select id, num, 
           id - row_number() over(partition by num order by id) dif
    from Logs
) t
group by num, dif 
having count(*) >= 3;
```


#### 关键函数
- `row_number()`：分组内生成递增序号，需配合 `partition by`（分组）和 `order by`（排序）；
- `group by + having`：按差值分组后筛选连续次数≥3的数字。