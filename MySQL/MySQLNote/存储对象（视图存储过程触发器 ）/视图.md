# 介绍及基本语法

## 1. 介绍

* **定义**：视图（View）是一种**虚拟存在**的表。
* **数据来源**：视图中的数据并不在数据库中实际存在，行和列数据来自定义视图的查询中使用的表（基表），并且是在使用视图时**动态生成**的。
* **本质**：通俗地讲，视图只**保存了查询的 SQL 逻辑**，不保存查询结果。因此在创建视图时，主要的工作就落在创建这条 SQL 查询语句上。

---

## 2. 常用操作指令

### 2.1 创建视图

```sql
CREATE [OR REPLACE] VIEW 视图名称[(列名列表)] AS SELECT语句 [WITH [CASCADED | LOCAL] CHECK OPTION];

```

### 2.2 查询视图

* **查看视图定义**（查看创建语句）：
```sql
SHOW CREATE VIEW 视图名称;

```


* **查看视图数据**：
```sql
SELECT * FROM 视图名称 ......;

```



### 2.3 修改视图

* **方式一**：使用 `CREATE OR REPLACE VIEW` 指令。
```sql
CREATE [OR REPLACE] VIEW 视图名称[(列名列表)] AS SELECT语句 [WITH [CASCADED | LOCAL] CHECK OPTION];

```


* **方式二**：使用 `ALTER VIEW` 指令。
```sql
ALTER VIEW 视图名称[(列名列表)] AS SELECT语句 [WITH [CASCADED | LOCAL] CHECK OPTION];

```



### 2.4 删除视图

```sql
DROP VIEW [IF EXISTS] 视图名称 [,视图名称] ...

```


根据您上传的最后一张图片，以下是关于 **视图检查选项（CASCADED）** 的 Markdown 笔记整理：

---

# 视图的检查选项 - CASCADED

## 1. 简介

当使用 `WITH CHECK OPTION` 子句创建视图时，MySQL 会通过视图检查正在更改的每个行（例如：插入、更新、删除），以使其符合视图的定义。此外，MySQL 允许基于另一个视图创建新视图，它还会检查依赖视图中的规则以保持一致性。

为了确定检查的范围，MySQL 提供了两个选项：`CASCADED` 和 `LOCAL`，**默认值为 `CASCADED**`。

---

## 2. CASCADED（级联）

当视图定义了 `WITH CASCADED CHECK OPTION` 时，MySQL 会检查当前视图的条件，并且会**级联检查**它所依赖的所有底层视图的条件，无论底层视图是否定义了检查选项。

## 3. 级联示例分析

* **视图 v1**：
```sql
create view v1 as select id, name from student where id <= 20 with cascaded check option;

```


* 操作 v1 时，必须满足 `id <= 20`。


* **视图 v2**（基于 v1）：
```sql
create view v2 as select id, name from v1 where id >= 10 with cascaded check option;

```


* 操作 v2 时，由于是 `CASCADED`，必须同时满足 v2 的 `id >= 10` 和 v1 的 `id <= 20`。


* **视图 v3**（基于 v2）：
```sql
create view v3 as select id, name from v2 where id <= 15;

```


* 虽然 v3 本身没有显式写 `CHECK OPTION`，但因为它依赖于定义了 `CASCADED` 的 v2，所以操作 v3 时依然会受到 v2 和 v1 条件的约束（必须满足 `10 <= id <= 20`），但不会检查 v3 自己的 `id <= 15` 条件。

根据您上传的图片内容，以下是关于 **视图检查选项（LOCAL）** 的 Markdown 笔记：

---

# 视图的检查选项 - LOCAL

## 1. 简介

在 MySQL 中，除了默认的 `CASCADED` 选项外，还可以使用 `LOCAL` 检查选项。当定义视图时使用 `WITH LOCAL CHECK OPTION`，MySQL 会在对该视图进行数据更改时进行条件检查。

## 2. LOCAL（本地）级联规则

当视图定义了 `WITH LOCAL CHECK OPTION` 时，MySQL 会执行以下检查逻辑：

* **检查本级条件**：首先检查当前视图定义的 `where` 条件是否满足。
* **向上级联检查**：会递归检查该视图所依赖的所有上层视图。
* **检查开关**：与 `CASCADED` 不同，`LOCAL` 在向上级联时，只有当父级视图**也定义了检查选项**（无论 `LOCAL` 还是 `CASCADED`）时，才会执行该父级视图的条件检查；如果父级没有定义检查选项，则跳过该父级的条件检查。

## 3. LOCAL 示例分析

根据图片中的示例结构：

* **视图 v1**：
```sql
create view v1 as select id, name from student where id <= 15;

```


* **状态**：未定义任何检查选项。


* **视图 v2**（基于 v1）：
```sql
create view v2 as select id, name from v1 where id >= 10 with local check option;

```


* **规则**：操作 v2 时，MySQL 会检查 v2 的条件 (`id >= 10`)。
* **级联效果**：向上找 v1，但因为 v1 没有定义检查选项，所以**不会**检查 v1 的 `id <= 15` 条件。


* **视图 v3**（基于 v2）：
```sql
create view v3 as select id, name from v2 where id < 20;

```


* **规则**：v3 自身没有检查选项，但操作 v3 涉及其父类 v2。由于 v2 有 `local check option`，因此必须满足 v2 的条件 (`id >= 10`)。



---

**总结对比：**

* **CASCADED**：只要底层的视图设置了，就会检查所有依赖视图的条件，不管上层有没有设置。
* **LOCAL**：只会检查设置了检查选项的视图及其父级中有检查选项的部分。

根据你上传的两张关于**视图作用**与**视图更新限制**的图片，整理后的 Markdown 内容如下：

---

# 更新及作用

## 1. 视图的作用

视图不仅可以简化用户对数据的理解，也可以简化它们的操作。其主要作用体现在以下三个方面：

* **简单**
* 那些被经常使用的查询可以被定义为视图，从而使得用户不必在以后的操作中每次都指定全部的条件。


* **安全**
* 数据库可以授权，但不能授权到数据库特定行和特定的列上。通过视图，用户只能查询和修改他们所能见到和访问的数据。


* **数据独立**
* 视图可帮助用户屏蔽真实表结构变化带来的影响。



---

## 2. 视图的更新

要使视图可更新，视图中的行与基础表中的行之间必须存在**一对一**的关系。

如果视图包含以下任何一项，则该视图**不可更新**：

1. **聚合函数**或**窗口函数**：如 `SUM()`、`MIN()`、`MAX()`、`COUNT()` 等。
2. **DISTINCT** 关键字。
3. **GROUP BY** 子句。
4. **HAVING** 子句。
5. **UNION** 或者 **UNION ALL** 关键字。
