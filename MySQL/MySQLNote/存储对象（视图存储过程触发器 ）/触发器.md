# 触发器 (Trigger)

## 1. 介绍

触发器是与表有关的数据库对象，指在 `insert` / `update` / `delete` 之前（BEFORE）或之后（AFTER），触发并执行触发器中定义的 SQL 语句集合。

* **主要用途**：协助应用在数据库端确保数据的完整性、日志记录、数据校验等操作。
* **别名引用**：使用别名 `OLD` 和 `NEW` 来引用触发器中发生变化的记录内容，这与其他数据库相似。
* **限制**：目前 MySQL 触发器还只支持**行级触发**，不支持语句级触发。

---

## 2. NEW 与 OLD 的具体含义

触发器在不同的操作类型中，`NEW` 和 `OLD` 所代表的数据含义不同：

| 触发器类型 | NEW 和 OLD 的含义 |
| --- | --- |
| **INSERT 型触发器** | **NEW** 表示将要或者已经新增的数据。 |
| **UPDATE 型触发器** | **OLD** 表示修改之前的数据；**NEW** 表示将要或者已经修改后的数据。 |
| **DELETE 型触发器** | **OLD** 表示将要或者已经删除的数据。 |

---

### 💡 核心理解

触发器就像是数据库里的“**自动监视器**”。你不需要手动去调用它，只要你对表做了增、删、改的操作，它就会按照你预设的逻辑自动跑起来。

根据您上传的最后一张图片（`image_312611.jpg`），这是关于 **触发器（Trigger）语法** 的详细说明。以下是为您整理的 Markdown 笔记：

---

## 语法

### 1. 创建触发器

使用 `CREATE TRIGGER` 语句来定义一个新的触发器。

```sql
CREATE TRIGGER trigger_name
BEFORE/AFTER INSERT/UPDATE/DELETE
ON tbl_name FOR EACH ROW -- 行级触发器
BEGIN
    trigger_stmt ;
END;

```

* **trigger_name**: 触发器的名称。
* **BEFORE/AFTER**: 定义触发时机，是在操作发生前还是发生后执行。
* **INSERT/UPDATE/DELETE**: 定义触发操作，即监视哪种数据变动。
* **ON tbl_name**: 指定该触发器建立在哪个表上。
* **FOR EACH ROW**: **行级触发器**。表示受影响的每一行记录都会激活一次触发器。

### 2. 查看触发器

可以查看当前数据库中已经定义的所有触发器：

```sql
SHOW TRIGGERS ;

```

### 3. 删除触发器

如果不再需要某个触发器，可以使用 `DROP` 语句将其删除：

```sql
DROP TRIGGER [schema_name.]trigger_name ;

```

* **注意**：如果没有指定 `schema_name`（数据库名），默认为当前所在的数据库。
