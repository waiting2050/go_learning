### 巴士乘客体重限制问题

#### 问题
从按`turn`顺序排队的乘客中，找出最后一个上巴士且累计体重≤1000的乘客姓名。


#### 样例数据
| person_id | person_name | weight | turn |
|-----------|-------------|--------|------|
| 5         | Alice       | 250    | 1    |
| 4         | Bob         | 175    | 5    |
| 3         | Alex        | 350    | 2    |
| 6         | John Cena   | 400    | 3    |
| 1         | Winston     | 500    | 6    |
| 2         | Marie       | 200    | 4    |


#### 思路
1. **累计体重计算**：按`turn`顺序计算累计体重（窗口函数`sum(weight) over (order by turn)`）。
2. **筛选有效记录**：保留累计体重≤1000的行。
3. **取最后一个**：按累计体重降序排序，取第一条（即最大符合条件的累计体重对应的乘客）。


#### 代码
```sql
select person_name 
from (
    select person_name, sum(weight) over (order by turn) tot_weight
    from Queue 
) t 
where tot_weight <= 1000
order by tot_weight desc
limit 1;
```


#### 关键函数
- `sum() over (order by turn)`：按`turn`顺序计算累计和（窗口函数）。
- `order by ... desc + limit 1`：获取符合条件的最大值对应的记录。