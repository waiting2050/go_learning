# Golang Lab4 - 视频网站项目需求文档

## 1. 项目概述

### 1.1 项目背景
金三银四招聘季来临，FanOne 正在准备面试，由于竞争过于激烈，想要放松一下观看番剧，但没有大会员。本项目旨在开发一个视频网站，让用户能够在没有大会员的条件下开心地追番。

### 1.2 项目目的
- 掌握 HTTP 协议和 Web 工作原理
- 掌握现代 HTTP 框架开发流程
- 掌握数据库的增删改查（CRUD）及基础的数据库表设计
- 入门简单的缓存引入和使用
- 入门简单的项目设计模式

### 1.3 项目选择
本 Lab 提供三个选择：
1. 参加 2024 年服务外包创新创业大赛（需同组长商量）
2. 完成 MIT 6.824 分布式系统（2024 Spring）的 lab2
3. 完成本视频网站项目

---

## 2. 技术要求

### 2.1 开发框架
- **必须使用**：Hertz/Kratos/其他现代 HTTP 框架
- **禁止使用**：Gin 框架
- **要求**：使用自动生成开发脚手架（如 Hertz 提供的 hz 工具以及 kratos 中集成的 protobuf）

### 2.2 技术栈
- HTTP 库建议：Hertz（https://www.cloudwego.io/zh/docs/hertz/）
- 数据库：关系型数据库
- 缓存：Redis（用于热门排行榜）
- 容器化：Docker

### 2.3 核心技术要求
- **双 Token 支持**：必须实现双 Token 机制
- **分页管理**：正确识别和处理 page_num 和 page_size 参数
- **视频搜索**：搜索条件需要全部满足（SQL 实现）
- **Docker 部署**：编写 Dockerfile 并成功部署项目（不要求上传镜像到 hub）
- **项目结构图**：提供项目目录树结构

---

## 3. 功能需求

### 3.1 最低功能要求（17个接口）

#### 3.1.1 用户模块（4个接口）
- 用户注册
- 用户登录
- 获取用户信息
- 上传头像

#### 3.1.2 视频模块（4个接口）
- 视频投稿
- 发布列表
- 搜索视频
- 热门排行榜

#### 3.1.3 互动模块（5个接口）
- 点赞操作
- 点赞列表
- 发表评论
- 评论列表
- 删除评论

#### 3.1.4 社交模块（4个接口）
- 关注操作
- 关注列表
- 粉丝列表
- 好友列表

### 3.2 接口文档规范
- 必须遵循接口文档规范：https://doc.west2.online/
- 请求和返回结构必须严格遵循接口文档
- 建议使用 Apifox 进行接口调试

---

## 4. 功能限制与豁免

### 4.1 不需要完成的内容
- 不需要考虑性能优化
- 不需要考虑设计模式/项目结构（只需完成项目）
- 不需要实现其他复杂功能，只需跑通接口

### 4.2 互动模块限制
- **评论功能**：只要求完成对视频的评论，不需要实现对评论的评论（comment_id 字段功能不需要实现）
- **点赞功能**：只要求完成对视频的点赞，不需要处理对评论的点赞

### 4.3 视频模块限制
- **投稿接口**：不要求实现分片上传和分布式存储，只需正常接收文件并保存到本地某个目录

### 4.4 社交模块限制
- 不需要完成 WebSocket 部分

### 4.5 业务逻辑要求
- **删除评论**：不可删除其他人的评论
- **上传视频**：需考虑用户是否登录等业务逻辑

---

## 5. Bonus 功能（可选）

### 5.1 高级功能
- 实现全部接口的全部功能
- 对点赞操作引入 Redis 缓存
- 不使用文档中的投稿接口，改用自己设计接口，实现视频的分片上传与存储
- 实现 WebSocket 聊天功能
- 引入 ElasticSearch，加强项目的日志管理

---

## 6. 项目架构与设计要求

### 6.1 数据库设计
- 设计合理的数据库表结构
- 特别关注互动和社交部分的表设计
- 考虑关系型数据库表的设计规范

### 6.2 项目结构
- 提供清晰的项目结构图（目录树）
- 设计可复用的 Model（User、Comment、Video 等）
- 特别关注社交部分的逻辑设计

### 6.3 重点关注内容
**不要过度关注 CRUD 内容，应重点关注以下方面：**
- 项目架构是否合理
- 数据库设计是否合理
- 是否对新技术（如 Redis）的使用相对合理
- 每一个接口的逻辑是否正确（例如，在上传视频时是否考虑到了用户是否登录？）
- 接口能否支撑多人访问？
- 使用缓存后，是否能避免缓存穿透、缓存雪崩等情况？

---

## 7. Redis 使用要求

### 7.1 热门排行榜
- 热门排行榜功能必须使用 Redis
- 实现方式：用户请求一次后将排行榜存储在 Redis，后续请求直接从 Redis 读取
- 不需要考虑过深的逻辑，只需中间使用到 Redis 即可

### 7.2 缓存优化（Bonus）
- 对点赞操作引入 Redis 缓存
- 考虑缓存穿透、缓存雪崩等问题的解决方案

---

## 8. 项目后续规划

### 8.1 短期目标
- 在本次项目基础上，实现接口文档的全部功能
- 在答辩后，依据设计模式/项目结构规范修改项目
- 在答辩后，依据数据库性能优化实践优化数据库设计

### 8.2 中期目标
- 使用 CI/CD 强化项目工作流
- 引入中间件
- 提升程序鲁棒性
- 了解 DevOps 理念

### 8.3 长期目标
- 下半年全部作业都将在本次项目基础上进行增添和修改
- 请认真对待项目结构，后续将侧重点放在更加现代且核心的要素上

---

## 9. 参考资源

### 9.1 官方文档
- MinIO 官网
- Redis 官网
- Elasticsearch 官网
- RabbitMQ 官网

### 9.2 技术指南
- 如何在 Go 语言中使用 Websockets：最佳工具与行动指南

### 9.3 开发工具
- Apifox：接口调试工具
- Hertz：HTTP 框架（https://www.cloudwego.io/zh/docs/hertz/）

---

## 10. 重要提示

### 10.1 项目持续性
- 下半年的全部作业都要求在本次项目基础上进行增添和修改
- 请认真对待项目结构和数据库设计
- 如果认为当前实现不理想，建议提前实现剩余接口和不要求完成的内容

### 10.2 答辩准备
- 答辩后会要求修改项目中不合理的结构和表设计
- 建议提前优化设计模式、项目结构规范和数据库性能

### 10.3 开发建议
- 关注项目的返回结构设计
- 设计可复用的 Model 结构
- 注意业务逻辑的正确性
- 考虑多人访问场景下的接口稳定性

---

## 11. 附录

### 11.1 接口文档
完整接口文档：https://doc.west2.online/

### 11.2 项目统计
- 最低接口数量：17 个
- 用户模块：4 个接口
- 视频模块：4 个接口
- 互动模块：5 个接口
- 社交模块：4 个接口

---

**文档版本**：1.0  
**创建日期**：2026-02-13  
**项目名称**：Golang Lab4 - 视频网站  
**适用范围**：项目开发与答辩